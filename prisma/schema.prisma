generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}


model actividades {
  actID          Int      @id @default(autoincrement())
  RunnerUID      String   @db.VarChar(36)
  plataforma     String   @db.Char(1)
  titulo         String   @db.VarChar(150)
  fechaActividad DateTime @db.DateTime(0)
  DistanciaKM    Decimal  @db.Decimal(6, 2)
  RitmoMinKm     String   @db.VarChar(10)
  Duracion       String   @db.VarChar(10)
  Origen         String   @db.VarChar(20)
  Ciudad         String   @db.VarChar(20)
  Pais           String   @db.VarChar(20)
  enlace         String   @db.VarChar(255)

  @@map("actividades")
}

model sec_users {
  RunnerUID                String    @default(uuid()) @db.Char(36)
  RunnerUIDRef             String?   @db.Char(36)
  AliasRunner              String?   @db.VarChar(50)
  DisciplinaPrincipal      String?   @db.Char(1)
  name                     String    @db.VarChar(255)
  login                    String    @id @db.VarChar(255)
  phone                    String    @db.VarChar(65)
  email                    String    @db.VarChar(255)
  pswd                     String    @db.VarChar(255)
  RFC                      String?   @db.VarChar(13)
  TipoMembresia            String?   @db.Char(1)
  FechaUltimaActividad     DateTime? @db.DateTime(0)
  FechaRegistro            DateTime  @default(now()) @db.Timestamp(0)
  FechaActualizacion       DateTime  @default(now()) @updatedAt @db.Timestamp(0)
  InvitacionesTotales      Int?      @default(0)
  SuscripcionMXN           Decimal?  @db.Decimal(10, 2)
  WalletPuntos             Int?
  WalletPuntosI            Int?
  WalletSaldoMXN           Decimal?  @default(0.00) @db.Decimal(10, 2)
  GananciasAcumuladasMXN   Decimal?  @default(0.00) @db.Decimal(10, 2)
  InvitacionesMensuales    Int?      @default(0)
  PorcentajeCumplimiento   Decimal?  @default(0.00) @db.Decimal(5, 2)
  NivelRunner              String?   @db.Char(1)
  FechaRenovacionMembresia DateTime? @db.Date
  CFDIEmitido              Boolean?  @default(false)
  StravaAthleteID          BigInt?
  GarminUserID             String?   @db.VarChar(64)
  Z2TotalHistorico         BigInt?   @default(0)
  Z2Recibidas30d           Int?      @default(0)
  Z2Otorgadas30d           Int?      @default(0)
  Actividades30d           Int?      @default(0)
  NivelMensual             String?   @db.VarChar(10)
  FechaUltimaZ2            DateTime? @db.DateTime(0)
  fechaNacimiento          DateTime? @db.Date
  Genero                   String?   @db.Char(1)
  Peso                     String?   @db.Char(2)
  Estatura                 String?   @db.Char(3)
  Ciudad                   String?   @db.VarChar(50)
  Estado                   String?   @db.VarChar(50)
  Pais                     String?   @db.VarChar(50)
  EmergenciaContacto       String?   @db.VarChar(255)
  EmergenciaCelular        String?   @db.Char(64)
  EmergenciaParentesco     String?   @db.Char(64)
  equipoID                 String?   @db.VarChar(36)
  active                   String?   @db.VarChar(1)
  activation_code          String?   @db.VarChar(32)
  priv_admin               String?   @db.VarChar(1)
  mfa                      String?   @db.VarChar(255)
  picture                  Bytes?    @db.Blob
  role                     String?   @db.VarChar(128)
  pswd_last_updated        DateTime? @default(now()) @updatedAt @db.Timestamp(0)
  mfa_last_updated         DateTime? @default(now()) @db.DateTime(0)

  @@map("sec_users")
}

model zonas {
  zonaID       Int      @id @default(autoincrement())
  RunnerUID    String   @db.VarChar(36)
  RunnerUIDRef String   @db.VarChar(36)
  puntos       Int
  motivo       String   @db.Char(2)
  origen       String   @db.Char(2)
  fecha        DateTime @db.DateTime(0)

  @@map("zonas")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model establecimientos {
  EstablecimientoID            Int                      @id @default(autoincrement()) @db.UnsignedInt
  NombreComercial              String                   @db.VarChar(255)
  Giro                         String?                  @db.VarChar(150)
  Descripcion                  String?                  @db.VarChar(255)
  Ciudad                       String?                  @db.VarChar(100)
  Estado                       String?                  @db.VarChar(100)
  Pais                         String?                  @default("México") @db.VarChar(100)
  Direccion                    String?                  @db.VarChar(255)
  Latitud                      Decimal?                 @db.Decimal(10, 7)
  Longitud                     Decimal?                 @db.Decimal(10, 7)
  UrlSitio                     String?                  @db.VarChar(500)
  UrlLogo                      String?                  @db.VarChar(500)
  AceptaPuntosZ2               Boolean                  @default(true)
  MaxPuntosZ2                  Int?                     @db.UnsignedInt
  MaxDescuentoZ2               Int?                     @db.UnsignedInt
  PuntosEquivalencia           Int?                     @db.UnsignedInt
  EquivalenciaDescuentoImporte Decimal?                 @db.Decimal(10, 2)
  Estatus                      establecimientos_Estatus @default(pendiente)
  FechaAlta                    DateTime                 @default(now()) @db.Timestamp(0)
  FechaActualiza               DateTime                 @default(now()) @db.Timestamp(0)

  @@map("establecimientos")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model eventos {
  EventoID            Int              @id @default(autoincrement()) @db.UnsignedInt
  OrgID               Int              @db.UnsignedInt
  Titulo              String           @db.VarChar(255)
  Subtitulo           String?          @db.VarChar(255)
  TipoEvento          String?          @default("Carrera") @db.VarChar(50)
  Distancias          String?          @db.VarChar(150)
  FechaEvento         DateTime         @db.Date
  HoraEvento          DateTime         @db.Time(0)
  Ciudad              String?          @db.VarChar(100)
  Estado              String?          @db.VarChar(100)
  Lugar               String?          @db.VarChar(255)
  UrlMapa             String?          @db.VarChar(500)
  UrlCalendario       String?          @db.VarChar(500)
  UrlImagen           String?          @db.VarChar(500)
  UrlRegistro         String?          @db.VarChar(500)
  UrlPagoDirecto      String?          @db.VarChar(500)
  MaxPuntosZ2         Int?             @db.UnsignedInt
  MaxDescuentoZ2      Int?             @db.UnsignedInt
  PuntosEquivalencia  Int?             @db.UnsignedInt
  DescuentoImporte    Decimal?         @db.Decimal(10, 2)
  UrlCartaExoneracion String?          @db.VarChar(500)
  GuiaExpectador      String?          @db.VarChar(500)
  PrecioEvento        Decimal?         @db.Decimal(10, 2)
  Moneda              String?          @default("MXN") @db.Char(3)
  Estatus             eventos_Estatus? @default(borrador)
  FechaAlta           DateTime         @default(now()) @db.Timestamp(0)
  FechaActualiza      DateTime         @default(now()) @db.Timestamp(0)
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model organizadores {
  OrgID               Int                   @id @default(autoincrement()) @db.UnsignedInt
  RunnerUID           String?               @db.VarChar(36)
  NombreComercial     String                @db.VarChar(255)
  RazonSocial         String?               @db.VarChar(255)
  RFC                 String?               @db.VarChar(13)
  ContactoNombre      String?               @db.VarChar(150)
  ContactoEmail       String?               @db.VarChar(150)
  ContactoTelefono    String?               @db.VarChar(50)
  Ciudad              String?               @db.VarChar(100)
  Estado              String?               @db.VarChar(100)
  Pais                String?               @default("México") @db.VarChar(100)
  UrlSitio            String?               @db.VarChar(500)
  UrlLogo             Bytes?                @db.Blob
  StripeAccountID     String?               @db.VarChar(255)
  enlaceStripe        String?               @db.VarChar(255)
  enlacePayPal        String?               @db.VarChar(255)
  enlaceMercadodePago String?               @db.VarChar(255)
  enlaceConekta       String?               @db.VarChar(255)
  enlaceClip          String?               @db.VarChar(255)
  enlace_OpenpayBBVA  String?               @db.VarChar(255)
  enlace_PayU         String?               @db.VarChar(255)
  enlace_Dashport     String?               @db.VarChar(255)
  AceptaPuntosZ2      Boolean               @default(true)
  MaxPuntosZ2         Int?                  @db.UnsignedInt
  MaxDescuentoZ2      Int?                  @db.UnsignedInt
  PuntosEquivalencia  Int?                  @db.UnsignedInt
  DescuentoImporte    Decimal?              @db.Decimal(10, 2)
  Estatus             organizadores_Estatus @default(pendientez)
  FechaAlta           DateTime?             @default(now()) @db.Timestamp(0)
  FechaActualiza      DateTime?             @default(now()) @db.Timestamp(0)
}

model sec_settings {
  set_name  String  @id @db.VarChar(255)
  set_value String? @db.VarChar(255)
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model subscriptions {
  SubscriptionUID     String                         @id @db.Char(36)
  RunnerUID           String                         @db.Char(36)
  PlanCode            subscriptions_PlanCode
  PlanVersion         Int?                           @default(1)
  BillingCycle        subscriptions_BillingCycle     @default(Yearly)
  Status              subscriptions_Status           @default(Pending)
  AutoRenew           Boolean                        @default(true)
  StartAt             DateTime                       @default(now()) @db.Timestamp(0)
  EndAt               DateTime?                      @db.Timestamp(0)
  NextChargeAt        DateTime?                      @db.Timestamp(0)
  LastChargeAt        DateTime?                      @db.Timestamp(0)
  CanceledAt          DateTime?                      @db.Timestamp(0)
  CancelReason        String?                        @db.VarChar(100)
  Currency            String                         @default("MXN") @db.Char(3)
  PriceMXN            Decimal                        @default(200.00) @db.Decimal(10, 2)
  DiscountMXN         Decimal?                       @default(0.00) @db.Decimal(10, 2)
  TaxMXN              Decimal?                       @default(0.00) @db.Decimal(10, 2)
  LastTotalChargedMXN Decimal?                       @default(0.00) @db.Decimal(10, 2)
  PaymentMethod       subscriptions_PaymentMethod?
  PaymentProvider     subscriptions_PaymentProvider?
  PaymentTxnID        String?                        @db.VarChar(64)
  CFDIUUID            String?                        @db.VarChar(36)
  CFDISerie           String?                        @db.VarChar(10)
  CFDIFolio           String?                        @db.VarChar(20)
  Notes               String?                        @db.VarChar(255)
  CreatedAt           DateTime                       @default(now()) @db.Timestamp(0)
  UpdatedAt           DateTime                       @default(now()) @db.Timestamp(0)

  @@index([RunnerUID], map: "FK_subscriptions_runner")
}

enum establecimientos_Estatus {
  pendiente
  activo
  suspendido
  baja
}

enum subscriptions_PlanCode {
  Runner
  Pacer
  Visitante
  Organizador
}

enum subscriptions_BillingCycle {
  Monthly
  Quarterly
  Yearly
}

enum subscriptions_Status {
  Pending
  Active
  PastDue
  Canceled
  Expired
  Trial
}

enum subscriptions_PaymentMethod {
  Card
  Bank
  Transfer
  Wallet
  Cash
  Other
}

enum subscriptions_PaymentProvider {
  Stripe
  Conekta
  OpenPay
  PayPal
  Bank
  Internal
  Other
}

enum eventos_Estatus {
  borrador
  publicado
  cerrado
  cancelado
}

enum organizadores_Estatus {
  pendientez
  activo
  suspendido
  baja
}
